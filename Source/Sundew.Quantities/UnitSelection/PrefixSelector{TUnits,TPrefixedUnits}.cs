// --------------------------------------------------------------------------------------------------------------------
// <copyright file="PrefixSelector{TUnits,TPrefixedUnits}.cs" company="Hukano">
// Copyright (c) Hukano. All rights reserved.
// Licensed under the MIT license. See LICENSE file in the project root for full license information.
// </copyright>
// --------------------------------------------------------------------------------------------------------------------

namespace Sundew.Quantities.UnitSelection;

using Sundew.Quantities.Representations.Expressions;
using Sundew.Quantities.Representations.Units;

/// <summary>
/// Abstract base class for implementing a prefix selector.
/// </summary>
/// <typeparam name="TUnits">The type of the unit selector.</typeparam>
/// <typeparam name="TPrefixedUnits">The type of the prefixed units.</typeparam>
public abstract class PrefixSelector<TUnits, TPrefixedUnits> : ExponentSelector<TUnits, TPrefixedUnits>,
    IPrefixSelector<TUnits>
    where TPrefixedUnits : IPrefixSelector<TUnits>
{
    /// <summary>
    /// Gets the yotta.
    /// </summary>
    /// <value>
    /// The yotta.
    /// </value>
    public TUnits Yotta => this.GetUnits(Prefixes.Yotta);

    /// <summary>
    /// Gets the zetta.
    /// </summary>
    /// <value>
    /// The zetta.
    /// </value>
    public TUnits Zetta => this.GetUnits(Prefixes.Zetta);

    /// <summary>
    /// Gets the exa.
    /// </summary>
    /// <value>
    /// The exa.
    /// </value>
    public TUnits Exa => this.GetUnits(Prefixes.Exa);

    /// <summary>
    /// Gets the peta.
    /// </summary>
    /// <value>
    /// The peta.
    /// </value>
    public TUnits Peta => this.GetUnits(Prefixes.Peta);

    /// <summary>
    /// Gets the tera.
    /// </summary>
    /// <value>
    /// The tera.
    /// </value>
    public TUnits Tera => this.GetUnits(Prefixes.Tera);

    /// <summary>
    /// Gets the giga.
    /// </summary>
    /// <value>
    /// The giga.
    /// </value>
    public TUnits Giga => this.GetUnits(Prefixes.Giga);

    /// <summary>
    /// Gets the mega.
    /// </summary>
    /// <value>
    /// The mega.
    /// </value>
    public TUnits Mega => this.GetUnits(Prefixes.Mega);

    /// <summary>
    /// Gets the kilo.
    /// </summary>
    /// <value>
    /// The kilo.
    /// </value>
    public TUnits Kilo => this.GetUnits(Prefixes.Kilo);

    /// <summary>
    /// Gets the hecto.
    /// </summary>
    /// <value>
    /// The hecto.
    /// </value>
    public TUnits Hecto => this.GetUnits(Prefixes.Hecto);

    /// <summary>
    /// Gets the deca.
    /// </summary>
    /// <value>
    /// The deca.
    /// </value>
    public TUnits Deca => this.GetUnits(Prefixes.Deca);

    /// <summary>
    /// Gets the deci.
    /// </summary>
    /// <value>
    /// The deci.
    /// </value>
    public TUnits Deci => this.GetUnits(Prefixes.Deci);

    /// <summary>
    /// Gets the centi.
    /// </summary>
    /// <value>
    /// The centi.
    /// </value>
    public TUnits Centi => this.GetUnits(Prefixes.Centi);

    /// <summary>
    /// Gets the milli.
    /// </summary>
    /// <value>
    /// The milli.
    /// </value>
    public TUnits Milli => this.GetUnits(Prefixes.Milli);

    /// <summary>
    /// Gets the micro.
    /// </summary>
    /// <value>
    /// The micro.
    /// </value>
    public TUnits Micro => this.GetUnits(Prefixes.Micro);

    /// <summary>
    /// Gets the nano.
    /// </summary>
    /// <value>
    /// The nano.
    /// </value>
    public TUnits Nano => this.GetUnits(Prefixes.Nano);

    /// <summary>
    /// Gets the pico.
    /// </summary>
    /// <value>
    /// The pico.
    /// </value>
    public TUnits Pico => this.GetUnits(Prefixes.Pico);

    /// <summary>
    /// Gets the femto.
    /// </summary>
    /// <value>
    /// The femto.
    /// </value>
    public TUnits Femto => this.GetUnits(Prefixes.Femto);

    /// <summary>
    /// Gets the atto.
    /// </summary>
    /// <value>
    /// The atto.
    /// </value>
    public TUnits Atto => this.GetUnits(Prefixes.Atto);

    /// <summary>
    /// Gets the zepto.
    /// </summary>
    /// <value>
    /// The zepto.
    /// </value>
    public TUnits Zepto => this.GetUnits(Prefixes.Zepto);

    /// <summary>
    /// Gets the yocto.
    /// </summary>
    /// <value>
    /// The yocto.
    /// </value>
    public TUnits Yocto => this.GetUnits(Prefixes.Yocto);

    /// <summary>
    /// Specifies the prefix by the specified factor.
    /// </summary>
    /// <param name="factor">The factor.</param>
    /// <returns>The available units.</returns>
    public TUnits By(double factor)
    {
        return this.GetUnits(new FactoredPrefix(factor));
    }

    /// <summary>
    /// Gets the unit selector.
    /// </summary>
    /// <returns>The available units.</returns>
    protected abstract TUnits GetUnits();

    /// <summary>
    /// Gets the unit selector.
    /// </summary>
    /// <param name="prefix">The prefix.</param>
    /// <returns>The available units.</returns>
    private TUnits GetUnits(Prefix prefix)
    {
        this.SpecifyPrefix(prefix);
        return this.GetUnits();
    }
}